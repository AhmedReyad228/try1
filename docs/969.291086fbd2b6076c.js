"use strict";(self.webpackChunkfreshcart=self.webpackChunkfreshcart||[]).push([[969],{1969:(C,a,o)=>{o.r(a),o.d(a,{CheckoutComponent:()=>k});var d=o(6814),i=o(95),t=o(4769),f=o(1120),u=o(6286);function A(e,p){1&e&&(t.TgZ(0,"p",16),t._uU(1," details is Required "),t.qZA())}function l(e,p){1&e&&(t.TgZ(0,"p",16),t._uU(1," Min Length should be 3 chars "),t.qZA())}function c(e,p){1&e&&(t.TgZ(0,"p",16),t._uU(1," Max Length should be 20 chars "),t.qZA())}function v(e,p){if(1&e&&(t.TgZ(0,"div",14),t.YNc(1,A,2,0,"p",15),t.YNc(2,l,2,0,"p",15),t.YNc(3,c,2,0,"p",15),t.qZA()),2&e){const n=t.oxw();let s,r,_;t.xp6(1),t.Q6J("ngIf",null==(s=n.shippingAddress.get("details"))?null:s.getError("required")),t.xp6(1),t.Q6J("ngIf",null==(r=n.shippingAddress.get("details"))?null:r.getError("minlength")),t.xp6(1),t.Q6J("ngIf",null==(_=n.shippingAddress.get("details"))?null:_.getError("maxlength"))}}function Z(e,p){1&e&&(t.TgZ(0,"p",16),t._uU(1," phone is Required "),t.qZA())}function I(e,p){1&e&&(t.TgZ(0,"p",16),t._uU(1," Accept only Egyptian phone numbers "),t.qZA())}function T(e,p){if(1&e&&(t.TgZ(0,"div",14),t.YNc(1,Z,2,0,"p",15),t.YNc(2,I,2,0,"p",15),t.qZA()),2&e){const n=t.oxw();let s,r;t.xp6(1),t.Q6J("ngIf",null==(s=n.shippingAddress.get("phone"))?null:s.getError("required")),t.xp6(1),t.Q6J("ngIf",null==(r=n.shippingAddress.get("phone"))?null:r.getError("pattern"))}}function x(e,p){1&e&&(t.TgZ(0,"p",16),t._uU(1," city is Required "),t.qZA())}function E(e,p){1&e&&(t.TgZ(0,"p",16),t._uU(1," It isn't a city name "),t.qZA())}function U(e,p){if(1&e&&(t.TgZ(0,"div",14),t.YNc(1,x,2,0,"p",15),t.YNc(2,E,2,0,"p",15),t.qZA()),2&e){const n=t.oxw();let s,r;t.xp6(1),t.Q6J("ngIf",null==(s=n.shippingAddress.get("city"))?null:s.getError("required")),t.xp6(1),t.Q6J("ngIf",null==(r=n.shippingAddress.get("city"))?null:r.getError("pattern"))}}let k=(()=>{class e{constructor(n,s,r){this._ActivatedRoute=n,this._CartService=s,this._FormBuilder=r,this.cartId="",this.shippingAddress=this._FormBuilder.group({details:["",[i.kI.required,i.kI.minLength(3),i.kI.maxLength(20)]],phone:["",[i.kI.required,i.kI.pattern(/^01[0125][0-9]{8}$/)]],city:["",[i.kI.required,i.kI.pattern(/^[a-zA-Z]+(?:[\s-][a-zA-Z]+)*$/)]]})}ngOnInit(){this._ActivatedRoute.paramMap.subscribe({next:n=>{this.cartId=n.get("cartId")}})}handleForm(){this._CartService.checkoutToPay(this.cartId,this.shippingAddress.value).subscribe({next:n=>{"success"==n.status&&window.open(n.session.url,"_self")},error:n=>{console.log(n)}})}static#t=this.\u0275fac=function(s){return new(s||e)(t.Y36(f.gz),t.Y36(u.N),t.Y36(i.qu))};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["app-checkout"]],standalone:!0,features:[t.jDz],decls:24,vars:5,consts:[[1,"my-4","bg-main-light","p-4","mx-auto","w-75"],[3,"formGroup","ngSubmit"],["for","details"],["formControlName","details","id","details","cols","2","rows","2",1,"form-control"],["detailsInp",""],["class","alert alert-danger w-50 mx-auto text-center small mt-2",4,"ngIf"],[1,"my-2"],["for","phone"],["formControlName","phone","type","tel","id","phone",1,"form-control"],["phoneInp",""],["for","city"],["formControlName","city","type","text","id","city",1,"form-control"],["cityInp",""],[1,"btn-main","mt-3",3,"disabled"],[1,"alert","alert-danger","w-50","mx-auto","text-center","small","mt-2"],["class","m-0",4,"ngIf"],[1,"m-0"]],template:function(s,r){if(1&s&&(t.TgZ(0,"section",0)(1,"h1"),t._uU(2,"CheckOut Session"),t.qZA(),t.TgZ(3,"form",1),t.NdJ("ngSubmit",function(){return r.handleForm()}),t.TgZ(4,"div")(5,"label",2),t._uU(6,"details"),t.qZA(),t._UZ(7,"textarea",3,4),t.YNc(9,v,4,3,"div",5),t.qZA(),t.TgZ(10,"div",6)(11,"label",7),t._uU(12,"phone"),t.qZA(),t._UZ(13,"input",8,9),t.YNc(15,T,3,2,"div",5),t.qZA(),t.TgZ(16,"div")(17,"label",10),t._uU(18,"city"),t.qZA(),t._UZ(19,"input",11,12),t.YNc(21,U,3,2,"div",5),t.qZA(),t.TgZ(22,"button",13),t._uU(23," CheckOut "),t.qZA()()()),2&s){const _=t.MAs(8),y=t.MAs(14),M=t.MAs(20);let h,g,m;t.xp6(3),t.Q6J("formGroup",r.shippingAddress),t.xp6(6),t.Q6J("ngIf",(null==(h=r.shippingAddress.get("details"))?null:h.errors)&&((null==(h=r.shippingAddress.get("details"))?null:h.touched)||_.value.length>0)),t.xp6(6),t.Q6J("ngIf",(null==(g=r.shippingAddress.get("phone"))?null:g.errors)&&((null==(g=r.shippingAddress.get("phone"))?null:g.touched)||y.value.length>0)),t.xp6(6),t.Q6J("ngIf",(null==(m=r.shippingAddress.get("city"))?null:m.errors)&&((null==(m=r.shippingAddress.get("city"))?null:m.touched)||M.value.length>0)),t.xp6(1),t.Q6J("disabled",r.shippingAddress.invalid)}},dependencies:[d.ez,d.O5,i.UX,i._Y,i.Fj,i.JJ,i.JL,i.sg,i.u]})}return e})()},6286:(C,a,o)=>{o.d(a,{N:()=>f});var d=o(5619),i=o(4769),t=o(9862);let f=(()=>{class u{constructor(l){this._HttpClient=l,this.cartNumber=new d.X(0),this.baseUrl="https://ecommerce.routemisr.com/api/v1/cart"}addProduct(l){return this._HttpClient.post(this.baseUrl,{productId:l})}getUserCart(){return this._HttpClient.get(this.baseUrl)}updateCart(l,c){return this._HttpClient.put(this.baseUrl+`/${l}`,{count:c})}removeProduct(l){return this._HttpClient.delete(this.baseUrl+`/${l}`)}clearUserCart(){return this._HttpClient.delete(this.baseUrl)}checkoutToPay(l,c){return this._HttpClient.post(`https://ecommerce.routemisr.com/api/v1/orders/checkout-session/${l}?url=https://github.com/`,{shippingAddress:c})}static#t=this.\u0275fac=function(c){return new(c||u)(i.LFG(t.eN))};static#e=this.\u0275prov=i.Yz7({token:u,factory:u.\u0275fac,providedIn:"root"})}return u})()}}]);