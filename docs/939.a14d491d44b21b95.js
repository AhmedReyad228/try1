"use strict";(self.webpackChunkfreshcart=self.webpackChunkfreshcart||[]).push([[939],{939:(q,l,a)=>{a.r(l),a.d(l,{ForgetpasswordComponent:()=>N});var c=a(6814),n=a(95),e=a(4769),p=a(9862);let u=(()=>{class s{constructor(t){this._HttpClient=t,this.baseUrl="https://ecommerce.routemisr.com/api/v1/auth/"}forgetPassword(t){return this._HttpClient.post(this.baseUrl+"forgotPasswords",t)}resetCode(t){return this._HttpClient.post(this.baseUrl+"verifyResetCode",t)}resetPassword(t){return this._HttpClient.put(this.baseUrl+"resetPassword",t)}static#e=this.\u0275fac=function(o){return new(o||s)(e.LFG(p.eN))};static#t=this.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"})}return s})();var d=a(1120),m=a(2425);function _(s,i){1&s&&(e.TgZ(0,"p",11),e._uU(1," Email is Required "),e.qZA())}function g(s,i){1&s&&(e.TgZ(0,"p",11),e._uU(1," Email InValid Format "),e.qZA())}function f(s,i){if(1&s&&(e.TgZ(0,"div",9),e.YNc(1,_,2,0,"p",10),e.YNc(2,g,2,0,"p",10),e.qZA()),2&s){const t=e.oxw(2);let o,r;e.xp6(1),e.Q6J("ngIf",null==(o=t.forgetForm.get("email"))?null:o.getError("required")),e.xp6(1),e.Q6J("ngIf",null==(r=t.forgetForm.get("email"))?null:r.getError("email"))}}function w(s,i){if(1&s&&(e.TgZ(0,"p",12),e._uU(1),e.qZA()),2&s){const t=e.oxw(2);e.xp6(1),e.hij(" ",t.userMsg," ")}}function x(s,i){if(1&s){const t=e.EpF();e.TgZ(0,"section",1)(1,"form",2),e.NdJ("ngSubmit",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.forgetPassword())}),e.TgZ(2,"label",3),e._uU(3,"Email:"),e.qZA(),e._UZ(4,"input",4,5),e.YNc(6,f,3,2,"div",6),e.TgZ(7,"button",7),e._uU(8," Forget Password "),e.qZA(),e.YNc(9,w,2,1,"p",8),e.qZA()()}if(2&s){const t=e.MAs(5),o=e.oxw();let r;e.xp6(1),e.Q6J("formGroup",o.forgetForm),e.xp6(3),e.Q6J("ngModel",o.myEmail),e.xp6(2),e.Q6J("ngIf",(null==(r=o.forgetForm.get("email"))?null:r.errors)&&((null==(r=o.forgetForm.get("email"))?null:r.touched)||t.value.length>0)),e.xp6(1),e.Q6J("disabled",o.forgetForm.invalid),e.xp6(2),e.Q6J("ngIf",o.userMsg)}}function h(s,i){1&s&&(e.TgZ(0,"p",11),e._uU(1," Reset Code is Required "),e.qZA())}function C(s,i){1&s&&(e.TgZ(0,"p",11),e._uU(1," MinLength is 3 numbers "),e.qZA())}function F(s,i){if(1&s&&(e.TgZ(0,"div",9),e.YNc(1,h,2,0,"p",10),e.YNc(2,C,2,0,"p",10),e.qZA()),2&s){const t=e.oxw(2);let o,r;e.xp6(1),e.Q6J("ngIf",null==(o=t.resetCode.get("resetCode"))?null:o.getError("required")),e.xp6(1),e.Q6J("ngIf",null==(r=t.resetCode.get("resetCode"))?null:r.getError("minlength"))}}function Z(s,i){if(1&s&&(e.TgZ(0,"p",12),e._uU(1),e.qZA()),2&s){const t=e.oxw(2);e.xp6(1),e.hij(" ",t.userMsg," ")}}function T(s,i){if(1&s){const t=e.EpF();e.TgZ(0,"button",17),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.reSendAgain())}),e._uU(1," Resend Code "),e.qZA()}}function b(s,i){if(1&s){const t=e.EpF();e.TgZ(0,"section",1)(1,"form",2),e.NdJ("ngSubmit",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.newCode())}),e.TgZ(2,"label",13),e._uU(3,"Reset Code:"),e.qZA(),e._UZ(4,"input",14,15),e.YNc(6,F,3,2,"div",6),e.TgZ(7,"button",7),e._uU(8," Reset Code "),e.qZA(),e.YNc(9,Z,2,1,"p",8),e.qZA(),e.YNc(10,T,2,0,"button",16),e.qZA()}if(2&s){const t=e.MAs(5),o=e.oxw();let r;e.xp6(1),e.Q6J("formGroup",o.resetCode),e.xp6(5),e.Q6J("ngIf",(null==(r=o.resetCode.get("resetCode"))?null:r.errors)&&((null==(r=o.resetCode.get("resetCode"))?null:r.touched)||t.value.length>0)),e.xp6(1),e.Q6J("disabled",o.resetCode.invalid),e.xp6(2),e.Q6J("ngIf",o.userMsg),e.xp6(1),e.Q6J("ngIf",o.reSend)}}function v(s,i){1&s&&(e.TgZ(0,"p",11),e._uU(1," Reset Password is Required "),e.qZA())}function I(s,i){1&s&&(e.TgZ(0,"p",11),e._uU(1," Password must be at least 6 chars "),e.qZA())}function P(s,i){if(1&s&&(e.TgZ(0,"div",9),e.YNc(1,v,2,0,"p",10),e.YNc(2,I,2,0,"p",10),e.qZA()),2&s){const t=e.oxw(2);let o,r;e.xp6(1),e.Q6J("ngIf",null==(o=t.resetPassword.get("resetPassword"))?null:o.getError("required")),e.xp6(1),e.Q6J("ngIf",null==(r=t.resetPassword.get("resetPassword"))?null:r.getError("pattern"))}}function J(s,i){if(1&s&&(e.TgZ(0,"p",12),e._uU(1),e.qZA()),2&s){const t=e.oxw(2);e.xp6(1),e.hij(" ",t.userMsg," ")}}function A(s,i){if(1&s){const t=e.EpF();e.TgZ(0,"section",1)(1,"form",2),e.NdJ("ngSubmit",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.newPassword())}),e.TgZ(2,"label",18),e._uU(3,"Reset Password:"),e.qZA(),e._UZ(4,"input",19,20),e.YNc(6,P,3,2,"div",6),e.TgZ(7,"button",7),e._uU(8," Reset Password "),e.qZA(),e.YNc(9,J,2,1,"p",8),e.qZA()()}if(2&s){const t=e.MAs(5),o=e.oxw();let r;e.xp6(1),e.Q6J("formGroup",o.resetPassword),e.xp6(5),e.Q6J("ngIf",(null==(r=o.resetPassword.get("resetPassword"))?null:r.errors)&&((null==(r=o.resetPassword.get("resetPassword"))?null:r.touched)||t.value.length>0)),e.xp6(1),e.Q6J("disabled",o.resetPassword.invalid),e.xp6(2),e.Q6J("ngIf",o.userMsg)}}let N=(()=>{class s{constructor(t,o,r){this._ForgetpassService=t,this._Router=o,this._ToastrService=r,this.step1=!0,this.step2=!1,this.step3=!1,this.myEmail="",this.userEmail={},this.userMsg="",this.reSend=!1,this.forgetForm=new n.cw({email:new n.NI("",[n.kI.required,n.kI.email])}),this.resetCode=new n.cw({resetCode:new n.NI("",[n.kI.required,n.kI.minLength(3)])}),this.resetPassword=new n.cw({newPassword:new n.NI("",[n.kI.required,n.kI.pattern(/^[a-zA-Z0-9_@]{6,}$/)])})}forgetPassword(){this.userEmail=this.forgetForm.value,this.myEmail=this.forgetForm.value.email,this._ForgetpassService.forgetPassword(this.userEmail).subscribe({next:t=>{"success"==t.statusMsg&&(this.userMsg=t.message,this.step1=!1,this.step2=!0)},error:t=>{this.userMsg=t.error.message}})}newCode(){this._ForgetpassService.resetCode(this.resetCode.value).subscribe({next:o=>{"Success"==o.status&&(this.userMsg=o.status,this.step2=!1,this.step3=!0)},error:o=>{this.userMsg=o.error.message,this.reSend=!0}})}reSendAgain(){this._ForgetpassService.forgetPassword(this.userEmail).subscribe({next:t=>{"success"==t.statusMsg&&(this.userMsg="Reset code sent to your email")}})}newPassword(){let t=this.resetPassword.value;t.email=this.myEmail,this._ForgetpassService.resetPassword(t).subscribe({next:o=>{o.token&&(localStorage.setItem("eToken",o.token),this._ToastrService.success("Password Changed Successfully"),this._Router.navigate(["Ecommerce/home"]))},error:o=>{console.log(o)}})}static#e=this.\u0275fac=function(o){return new(o||s)(e.Y36(u),e.Y36(d.F0),e.Y36(m._W))};static#t=this.\u0275cmp=e.Xpm({type:s,selectors:[["app-forgetpassword"]],standalone:!0,features:[e.jDz],decls:3,vars:3,consts:[["class","mx-auto w-50 bg-main-light rounded shadow p-3 my-4",4,"ngIf"],[1,"mx-auto","w-50","bg-main-light","rounded","shadow","p-3","my-4"],[3,"formGroup","ngSubmit"],["for","email"],["formControlName","email","type","email","id","email",1,"form-control",3,"ngModel"],["emailInp",""],["class","alert alert-danger w-50 mx-auto text-center small mt-2",4,"ngIf"],[1,"btn-main","mt-3","w-100",3,"disabled"],["class","alert alert-danger p-1 mt-2 mx-auto w-75 text-center",4,"ngIf"],[1,"alert","alert-danger","w-50","mx-auto","text-center","small","mt-2"],["class","m-0",4,"ngIf"],[1,"m-0"],[1,"alert","alert-danger","p-1","mt-2","mx-auto","w-75","text-center"],["for","resetCode"],["formControlName","resetCode","type","text","id","resetCode",1,"form-control"],["codeInp",""],["class","btn border border-1 border-success bg-info",3,"click",4,"ngIf"],[1,"btn","border","border-1","border-success","bg-info",3,"click"],["for","resetPassword"],["formControlName","newPassword","type","password","id","resetPassword",1,"form-control"],["resetPass",""]],template:function(o,r){1&o&&(e.YNc(0,x,10,5,"section",0),e.YNc(1,b,11,5,"section",0),e.YNc(2,A,10,4,"section",0)),2&o&&(e.Q6J("ngIf",r.step1),e.xp6(1),e.Q6J("ngIf",r.step2),e.xp6(1),e.Q6J("ngIf",r.step3))},dependencies:[c.ez,c.O5,n.UX,n._Y,n.Fj,n.JJ,n.JL,n.sg,n.u]})}return s})()}}]);